before_script:
  - pwd

Syntax check php7:
  script: find . -name \*.php -exec php -l "{}" \;
  stage: build

Copy paste detection:
  script:
    - wget https://phar.phpunit.de/phpcpd.phar
    - php phpcpd.phar ./src/
  stage: build
  allow_failure: true

# disables due to phpmd issues
#PHP mess detection:
#  script:
#    - wget -c http://static.phpmd.org/php/latest/phpmd.phar
#    - php7 phpmd.phar ./src/ text cleancode codesize
#  stage: build
#  allow_failure: true

PhpUnit php7:
  script:
    - apt-get install -y apt-transport-https lsb-release ca-certificates --fix-missing
    - wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
    - echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" > /etc/apt/sources.list.d/php.list
    - apt-get update
    - apt-get install -y --force-yes --fix-missing php7.2 php7.2-mbstring php7.2-bcmath php7.2-curl
    - php -v
    - curl -sS https://getcomposer.org/installer | php
    - php composer.phar install
    - cd tests && php ../vendor/phpunit/phpunit/phpunit
  stage: build

#UI test:
#  script:
#    - docker build -t php7 .
#    - docker run -d -it -p 8080:80 php7
